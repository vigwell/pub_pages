<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מבחן טכני רמה 2 - תשובות מומלצות</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #11998e;
        }
        
        h1 {
            color: #2d3748;
            font-size: 28px;
            margin-bottom: 15px;
        }
        
        .confidential {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .question {
            margin-bottom: 40px;
            padding: 25px;
            background: #fafafa;
            border-right: 4px solid #11998e;
            border-radius: 8px;
        }
        
        .question h2 {
            color: #11998e;
            font-size: 20px;
            margin-bottom: 15px;
        }
        
        .answer-section {
            background: #e6fffa;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            border-right: 3px solid #38ef7d;
        }
        
        .answer-section h3 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        pre {
            background: #2d3748;
            color: #68d391;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
            direction: ltr;
            text-align: left;
        }
        
        code {
            direction: ltr;
            unicode-bidi: embed;
            background: #f7fafc;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        
        .points {
            background: #d4edda;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border-right: 3px solid #28a745;
        }
        
        .points strong {
            color: #155724;
        }
        
        ul, ol {
            margin-right: 20px;
            margin-top: 10px;
        }
        
        li {
            margin: 8px 0;
        }
        
        .evaluation-notes {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-right: 3px solid #ffc107;
        }
        
        .evaluation-notes strong {
            color: #856404;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                padding: 20px;
            }
            
            .question {
                page-break-inside: avoid;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 22px;
            }
            
            pre {
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>מבחן טכני - תמיכה טכנית רמה 2 למערכות רפואיות</h1>
            <h2 style="color: #11998e; font-size: 20px;">תשובות מומלצות ומפתח הערכה</h2>
        </header>

        <div class="confidential">
            ⚠️ מסמך זה מיועד למעריכים בלבד - אין להעביר למועמדים
        </div>

        <div class="question">
            <h2>שאלה 1: פתרון בעיות במסד נתונים SQL (20 נקודות)</h2>
            
            <div class="answer-section">
                <h3>תשובה 1.1 - תורים להיום (6 נקודות)</h3>
                <pre>SELECT * 
FROM appointments 
WHERE appointment_date = CURRENT_DATE 
  AND status = 'scheduled';</pre>
                
                <div class="points">
                    <strong>נקודות להערכה:</strong>
                    <ul>
                        <li>שימוש נכון ב-CURRENT_DATE או NOW()::DATE (3 נקודות)</li>
                        <li>תנאי WHERE עם סטטוס (2 נקודות)</li>
                        <li>תחביר תקין (1 נקודה)</li>
                    </ul>
                </div>
            </div>

            <div class="answer-section">
                <h3>תשובה 1.2 - ספירת תורים לרופא (7 נקודות)</h3>
                <pre>SELECT physician_id, COUNT(*) as appointment_count
FROM appointments 
WHERE appointment_date = CURRENT_DATE
GROUP BY physician_id
ORDER BY appointment_count DESC;</pre>
                
                <div class="points">
                    <strong>נקודות להערכה:</strong>
                    <ul>
                        <li>שימוש ב-COUNT(*) (2 נקודות)</li>
                        <li>GROUP BY נכון (3 נקודות)</li>
                        <li>תנאי WHERE עם תאריך היום (2 נקודות)</li>
                        <li>בונוס: ORDER BY (לא חובה)</li>
                    </ul>
                </div>
            </div>

            <div class="answer-section">
                <h3>תשובה 1.3 - זיהוי כפילויות (7 נקודות)</h3>
                <pre>SELECT appointment_date, appointment_time, COUNT(*) as duplicate_count
FROM appointments 
WHERE patient_id = 12345
GROUP BY appointment_date, appointment_time
HAVING COUNT(*) > 1;</pre>
                
                <div class="points">
                    <strong>נקודות להערכה:</strong>
                    <ul>
                        <li>שימוש ב-GROUP BY (3 נקודות)</li>
                        <li>שימוש ב-HAVING (3 נקודות)</li>
                        <li>לוגיקה נכונה לזיהוי כפילויות (1 נקודה)</li>
                    </ul>
                </div>
            </div>

            <div class="evaluation-notes">
                <strong>הערות להערכה:</strong> קבל גם וריאציות כמו DATE(NOW()), TODAY(), או ::date. החשוב הוא ההבנה של שאילתות בסיסיות והיכולת לזהות כפילויות.
            </div>
        </div>

        <div class="question">
            <h2>שאלה 2: ניתוח לוגים (20 נקודות)</h2>
            
            <div class="answer-section">
                <h3>תשובה 2.1 - הסיבה השורשית (8 נקודות)</h3>
                <p><strong>תשובה מלאה:</strong></p>
                <ul>
                    <li><strong>בעיה עיקרית:</strong> timeout בחיבור למסד הנתונים (Database connection timeout) - 4 נקודות</li>
                    <li><strong>סיבה משנית:</strong> שימוש גבוה בזיכרון (92%) שגרם לעצירת Application Pool - 4 נקודות</li>
                </ul>
                <p>הבעיה מתחילה בחיבור למסד נתונים שלוקח זמן רב מדי, מה שגורם לצבירת זיכרון ובסופו של דבר לקריסת ה-IIS Application Pool.</p>
            </div>

            <div class="answer-section">
                <h3>תשובה 2.2 - צעדים לפתרון (8 נקודות)</h3>
                <p><strong>צעדים מומלצים (4 נקודות לכל אחד):</strong></p>
                <ol>
                    <li><strong>אתחל את Application Pool 'MedicalImaging'</strong> כדי להחזיר את השירות לפעולה מיידית</li>
                    <li><strong>בדוק סטטוס של שרת מסד הנתונים:</strong>
                        <ul>
                            <li>האם השרת רץ ותקין?</li>
                            <li>בדוק חיבור רשת לשרת</li>
                            <li>בדוק עומס על שרת SQL</li>
                        </ul>
                    </li>
                    <li><strong>בדוק ניהול זיכרון:</strong>
                        <ul>
                            <li>זיהוי תהליכים שצורכים זיכרון רב</li>
                            <li>בדיקת memory leaks באפליקציה</li>
                        </ul>
                    </li>
                    <li><strong>בדוק connection strings</strong> וגדלי connection pool</li>
                </ol>
            </div>

            <div class="answer-section">
                <h3>תשובה 2.3 - מידע נוסף לאיסוף (4 נקודות)</h3>
                <ul>
                    <li>בדיקת ביצועים של שרת SQL (CPU, Memory, Disk I/O) - 1 נקודה</li>
                    <li>לוגים מפורטים יותר של שגיאות מסד הנתונים - 1 נקודה</li>
                    <li>היסטוריה של המקרה - מתי זה התחיל? האם קרה שינוי במערכת? - 1 נקודה</li>
                    <li>מספר משתמשים מחוברים בזמן הבעיה - 1 נקודה</li>
                </ul>
            </div>

            <div class="evaluation-notes">
                <strong>הערות להערכה:</strong> חשוב שהמועמד מזהה שיש שתי בעיות קשורות (DB timeout + Memory). תשובה חלקית שמזהה רק אחת מהן: 50% מהניקוד.
            </div>
        </div>

        <div class="question">
            <h2>שאלה 3: פתרון בעיות IIS (20 נקודות)</h2>
            
            <div class="answer-section">
                <h3>תשובה 3.1 - דרכי אתחול (6 נקודות - 2 לכל אחת)</h3>
                <ol>
                    <li><strong>IIS Manager (GUI):</strong> פתיחת IIS Manager → Application Pools → לחיצה ימנית → Start/Recycle</li>
                    <li><strong>Command Line:</strong>
                        <pre>appcmd start apppool /apppool.name:"MedicalRecords"</pre>
                    </li>
                    <li><strong>PowerShell:</strong>
                        <pre>Start-WebAppPool -Name "MedicalRecords"
# או
Restart-WebAppPool -Name "MedicalRecords"</pre>
                    </li>
                    <li><strong>בונוס:</strong> Web.config touch (שינוי קובץ תצורה כדי לגרום לאתחול אוטומטי)</li>
                </ol>
            </div>

            <div class="answer-section">
                <h3>תשובה 3.2 - סיבות לעצירה אוטומטית (6 נקודות - 3 לכל אחת)</h3>
                <ul>
                    <li><strong>הגיע למגבלת requests:</strong> Application Pool מוגדר עם מספר מקסימלי של requests לפני recycle</li>
                    <li><strong>שגיאות רציפות:</strong> אם יש מספר רב של שגיאות (crashes) ברצף, IIS יעצור את ה-pool אוטומטית</li>
                    <li><strong>תשובות נוספות מקובלות:</strong>
                        <ul>
                            <li>הגיע למגבלת זמן (time-based recycling)</li>
                            <li>צריכת זיכרון גבוהה מדי</li>
                            <li>CPU usage גבוה</li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div class="answer-section">
                <h3>תשובה 3.3 - בדיקה לפני אתחול (4 נקודות)</h3>
                <ul>
                    <li><strong>בדיקת Event Viewer</strong> לזיהוי הסיבה המדויקת לקריסה - 2 נקודות</li>
                    <li><strong>בדיקת IIS logs</strong> לשגיאות אפליקציה - 1 נקודה</li>
                    <li><strong>בדיקה אם יש deployment חדש</strong> או שינויים שנעשו לאחרונה - 1 נקודה</li>
                </ul>
            </div>

            <div class="answer-section">
                <h3>תשובה 3.4 - מעקב לאחר אתחול (4 נקודות)</h3>
                <ul>
                    <li>בדיקה ש-Application Pool רץ בצורה יציבה - 1 נקודה</li>
                    <li>מעקב אחר זמני תגובה של האפליקציה - 1 נקודה</li>
                    <li>ניטור שימוש בזיכרון ו-CPU - 1 נקודה</li>
                    <li>בדיקת לוגים לשגיאות חדשות - 1 נקודה</li>
                </ul>
            </div>

            <div class="evaluation-notes">
                <strong>הערות להערכה:</strong> קבל כל דרך תקפה לאתחול. החשוב שהמועמד יודע יותר מדרך אחת ומבין מתי להשתמש בכל אחת.
            </div>
        </div>

        <div class="question">
            <h2>שאלה 4: ניטור ואיתור בעיות במערכת (20 נקודות)</h2>
            
            <div class="answer-section">
                <h3>תשובה 4.1 - מדדי מערכת (6 נקודות - 2 לכל אחד)</h3>
                <ul>
                    <li><strong>Response Time / זמן תגובה:</strong> כמה זמן לוקח לאפליקציה להגיב לבקשות</li>
                    <li><strong>Database Performance:</strong> זמני שאילתה, מספר חיבורים פעילים, deadlocks</li>
                    <li><strong>Server Resources:</strong> CPU, RAM, Disk I/O של שרת האפליקציה ושרת SQL</li>
                    <li><strong>תשובות נוספות מקובלות:</strong>
                        <ul>
                            <li>Application Pool health / uptime</li>
                            <li>Error rates / exception count</li>
                            <li>מספר משתמשים מחוברים</li>
                            <li>Network latency</li>
                        </ul>
                    </ul>
            </div>

            <div class="answer-section">
                <h3>תשובה 4.2 - בעיות שמירה איטית (9 נקודות - 3 לכל אחת)</h3>
                <ul>
                    <li><strong>בעיות מסד נתונים:</strong>
                        <ul>
                            <li>שאילתת INSERT/UPDATE איטית</li>
                            <li>חוסר indexes מתאימים</li>
                            <li>Table locks או deadlocks</li>
                            <li>עומס גבוה על שרת SQL</li>
                        </ul>
                    </li>
                    <li><strong>בעיות רשת:</strong>
                        <ul>
                            <li>Latency גבוה בין שרת אפליקציה לשרת SQL</li>
                            <li>בעיות bandwidth</li>
                        </ul>
                    </li>
                    <li><strong>בעיות אפליקציה:</strong>
                        <ul>
                            <li>קוד לא יעיל (N+1 queries)</li>
                            <li>Transactions ארוכות</li>
                            <li>חוסר connection pooling</li>
                            <li>בעיות validation מורכבות</li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div class="answer-section">
                <h3>תשובה 4.3 - וידוא bottleneck במסד נתונים (5 נקודות)</h3>
                <p><strong>גישה מומלצת:</strong></p>
                <ol>
                    <li><strong>השתמש ב-SQL Profiler או Database Monitor</strong> לבדיקת זמני שאילתות - 2 נקודות</li>
                    <li><strong>בדוק ביצועי שרת SQL:</strong> CPU, Memory, Disk I/O בזמן הפעולה - 1 נקודה</li>
                    <li><strong>הרץ את הפעולה עם logging מפורט</strong> ומדוד זמנים בכל שלב (application → network → database → back) - 1 נקודה</li>
                    <li><strong>השווה:</strong> אם רוב הזמן הוא בשלב ה-database, זה האתגר - 1 נקודה</li>
                </ol>
            </div>

            <div class="evaluation-notes">
                <strong>הערות להערכה:</strong> חשוב שהמועמד מציע גישה שיטתית ולא רק מנחש. יכולת לחלק בעיה לחלקים ולבדוק כל אחד בנפרד.
            </div>
        </div>

        <div class="question">
            <h2>שאלה 5: כתיבת שאילתות SQL מעשיות (20 נקודות)</h2>
            
            <div class="answer-section">
                <h3>תשובה 5.1 - מטופלים עם מרשם פעיל (5 נקודות)</h3>
                <pre>SELECT DISTINCT p.*
FROM patients p
JOIN prescriptions pr ON p.patient_id = pr.patient_id
WHERE pr.medication_name = 'Metformin'
  AND pr.status = 'active';</pre>
                
                <div class="points">
                    <strong>נקודות:</strong> JOIN נכון (2), WHERE עם שני תנאים (2), DISTINCT או קבוצה (1)
                </div>
            </div>

            <div class="answer-section">
                <h3>תשובה 5.2 - ספירת מרשמים לפי תרופה (5 נקודות)</h3>
                <pre>SELECT medication_name, COUNT(*) as prescription_count
FROM prescriptions
WHERE prescribed_date >= CURRENT_DATE - INTERVAL '7 days'
GROUP BY medication_name
ORDER BY prescription_count DESC;</pre>
                
                <div class="points">
                    <strong>נקודות:</strong> חישוב תאריך נכון (2), GROUP BY (2), COUNT (1)
                </div>
                <p><em>קבל גם: WHERE prescribed_date >= NOW() - INTERVAL '7 days' או DATE_SUB</em></p>
            </div>

            <div class="answer-section">
                <h3>תשובה 5.3 - מטופלים ללא מרשמים (6 נקודות)</h3>
                <p><strong>אפשרות 1 - LEFT JOIN:</strong></p>
                <pre>SELECT p.*
FROM patients p
LEFT JOIN prescriptions pr ON p.patient_id = pr.patient_id
WHERE pr.prescription_id IS NULL;</pre>
                
                <p><strong>אפשרות 2 - NOT EXISTS:</strong></p>
                <pre>SELECT p.*
FROM patients p
WHERE NOT EXISTS (
    SELECT 1 
    FROM prescriptions pr 
    WHERE pr.patient_id = p.patient_id
);</pre>
                
                <div class="points">
                    <strong>נקודות:</strong> 6 נקודות מלאות לכל פתרון תקין. חשוב שהלוגיקה נכונה.
                </div>
            </div>

            <div class="answer-section">
                <h3>תשובה 5.4 - בונוס: תיקון שאילתה (4 נקודות)</h3>
                <p><strong>הבעיה:</strong> פורמט התאריך '11/17/1980' הוא string ולא DATE, מה שעלול לגרום לבעיות תלוי בהגדרות.</p>
                
                <p><strong>תיקון מומלץ:</strong></p>
                <pre>SELECT patient_id, first_name 
FROM patients 
WHERE date_of_birth = '1980-11-17';

-- או
WHERE date_of_birth = DATE '1980-11-17';

-- או להשתמש ב-TO_DATE
WHERE date_of_birth = TO_DATE('11/17/1980', 'MM/DD/YYYY');</pre>
                
                <div class="points">
                    <strong>נקודות:</strong> זיהוי הבעיה (2), הצעת פתרון תקין (2)
                </div>
            </div>

            <div class="evaluation-notes">
                <strong>הערות להערכה:</strong> הסינטקס יכול להשתנות בין PostgreSQL ל-MySQL ל-SQL Server. קבל כל פתרון שעובד. החשוב הוא ההבנה של JOINs ו-subqueries.
            </div>
        </div>

        <div style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; padding: 30px; border-radius: 10px; margin-top: 40px;">
            <h2 style="margin-bottom: 20px; text-align: center;">סיכום הערכה כללי</h2>
            
            <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 8px; margin: 15px 0;">
                <strong>מועמד מצוין (90-100 נקודות):</strong>
                <ul style="margin-top: 10px;">
                    <li>כותב שאילתות SQL מורכבות בביטחון</li>
                    <li>מזהה בעיות מהר ומציע פתרונות שיטתיים</li>
                    <li>מבין את הקשר בין רכיבים שונים במערכת</li>
                    <li>חושב פרואקטיבית על ניטור ומניעה</li>
                </ul>
            </div>
            
            <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 8px; margin: 15px 0;">
                <strong>מועמד טוב (70-89 נקודות):</strong>
                <ul style="margin-top: 10px;">
                    <li>כותב שאילתות בסיסיות נכון</li>
                    <li>מזהה בעיות עם הכוונה</li>
                    <li>יודע מתי לאתחל שירותים</li>
                    <li>צריך ליווי בבעיות מורכבות</li>
                </ul>
            </div>
            
            <div style="background: rgba(255,255,255,0.15); padding: 15px; border-radius: 8px; margin: 15px 0;">
                <strong>מועמד שדורש פיתוח (מתחת ל-70 נקודות):</strong>
                <ul style="margin-top: 10px;">
                    <li>מתקשה עם SQL בסיסי</li>
                    <li>לא מציג מתודולוגיה לפתרון בעיות</li>
                    <li>חסר הבנה של מרכיבי מערכת</li>
                    <li>דורש הכשרה משמעותית</li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>